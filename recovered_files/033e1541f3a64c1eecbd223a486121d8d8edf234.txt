import { describe, it, expect, beforeEach } from 'vitest'
import { setActivePinia, createPinia } from 'pinia'
import { useTaskStore } from '../task'

describe('Task Store', () => {
  beforeEach(() => {
    setActivePinia(createPinia())
  })

  it('ordena las tareas correctamente por estado', () => {
    const store = useTaskStore()
    
    store.tasks = [
      { id: 1, status: 'COMPLETED', title: 'Tarea 1', description: '', priority: 1, due_date: null, user: null },
      { id: 2, status: 'IN_PROGRESS', title: 'Tarea 2', description: '', priority: 1, due_date: null, user: null },
      { id: 3, status: 'PENDING', title: 'Tarea 3', description: '', priority: 1, due_date: null, user: null }
    ]

    
    const sortedTasks = store.sortedTasks
    expect(sortedTasks[0].status).toBe('IN_PROGRESS')
    expect(sortedTasks[1].status).toBe('PENDING')
    expect(sortedTasks[2].status).toBe('COMPLETED')
  })

  it('calcula correctamente las estadÃ­sticas', () => {
    const store = useTaskStore()
    
    store.tasks = [
      { id: 1, status: 'COMPLETED', title: 'Tarea 1', description: '', priority: 1, due_date: null, user: null },
      { id: 2, status: 'PENDING', title: 'Tarea 2', description: '', priority: 1, due_date: null, user: null },
      { id: 3, status: 'PENDING', title: 'Tarea 3', description: '', priority: 1, due_date: null, user: null }
    ]

    expect(store.taskStats.pending).toBe(2)
    expect(store.taskStats.completed).toBe(1)
  })
}) 
